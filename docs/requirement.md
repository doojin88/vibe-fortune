# 요구사항 정의서

## 1. 프로젝트 개요

### 1.1 목적
AI 기반 사주 분석 서비스를 구독 모델로 제공

### 1.2 핵심 가치
- 간편한 Google 로그인
- 무료/유료 구독을 통한 차등화된 서비스
- AI 기반 고급 사주팔자 분석
- 편리한 자동 결제 시스템

---

## 2. 페이지 구성 및 화면 인터랙션

### 2.1 홈 (랜딩 페이지)
**접근 권한**: 누구나

**화면 구성**:
- 서비스 소개 및 주요 기능 설명
- 무료/Pro 플랜 비교 안내
- 로그인/회원가입 버튼

**사용자 인터랙션**:
- 로그인 버튼 클릭 → Google 로그인 화면으로 이동
- 회원가입 버튼 클릭 → Google 계정 연동 및 자동 회원가입
- 로그인 성공 → 대시보드로 자동 이동

### 2.2 대시보드
**접근 권한**: 로그인 필요

**화면 구성**:
- 현재 구독 상태 표시 (무료/Pro)
- 남은 사주분석 횟수 표시
- 과거 사주분석 이력 목록 (날짜, 이름, 미리보기)
- "새 사주분석하기" 버튼
- "구독 관리" 링크

**사용자 인터랙션**:
- 새 사주분석하기 버튼 클릭 → 새 사주분석 페이지로 이동
- 사주분석 이력 항목 클릭 → 해당 사주분석 상세 페이지로 이동
- 구독 관리 링크 클릭 → 구독 관리 페이지로 이동
- 남은 횟수 0회 시 → "새 사주분석하기" 버튼 비활성화 및 구독 안내 메시지 표시

### 2.3 새 분석하기
**접근 권한**: 로그인 필요

**화면 구성**:
- 입력 폼
  - 성함 (필수)
  - 생년월일 (필수, 날짜 선택)
  - 출생시간 (선택, 시간 선택)
  - 성별 (필수, 라디오 버튼)
- "사주분석 시작" 버튼
- 남은 사주분석 횟수 안내

**사용자 인터랙션**:
- 필수 항목 미입력 시 → 제출 버튼 비활성화
- 사주분석 시작 버튼 클릭 → 로딩 표시 후 AI 사주분석 진행
- 사주분석 완료 → 사주분석 상세 페이지로 자동 이동
- 남은 횟수 0회 시 → 폼 비활성화 및 구독 안내

### 2.4 사주분석 상세
**접근 권한**: 로그인 필요 (본인 사주분석만 조회 가능)

**화면 구성**:
- 사주분석 대상 정보 (이름, 생년월일, 출생시간, 성별)
- 사주분석 결과 (마크다운 렌더링)
  - 천간과 지지
  - 오행 분석
  - 대운과 세운
  - 성격, 재운, 건강운, 연애운
- "목록으로" 버튼
- "새 사주분석하기" 버튼

**사용자 인터랙션**:
- 목록으로 버튼 클릭 → 대시보드로 이동
- 새 사주분석하기 버튼 클릭 → 새 사주분석 페이지로 이동
- 사주분석 결과 복사 가능

### 2.5 구독 관리
**접근 권한**: 로그인 필요

**화면 구성**:
- 현재 구독 상태 표시
  - 무료: 남은 횟수 표시
  - Pro: 구독 상태, 다음 결제일, 남은 횟수
- 플랜 비교표 (무료 vs Pro)
- 구독 상태별 버튼
  - 무료 사용자: "Pro 구독하기" 버튼
  - Pro 활성: "구독 취소" 버튼
  - Pro 취소 예정: "취소 철회" 버튼, 남은 기간 안내
  - Pro 만료: "재구독하기" 버튼

**사용자 인터랙션**:
- Pro 구독하기 버튼 클릭 → 결제 화면으로 이동 (토스페이먼츠)
- 카드 정보 입력 및 인증 → 빌링키 발급
- 빌링키 발급 성공 → 즉시 9,900원 결제
- 결제 완료 → Pro 활성화, 분석 횟수 10회 지급, 구독 관리 페이지로 복귀
- 구독 취소 버튼 클릭 → 확인 모달 → 취소 처리 (다음 결제일까지 유지)
- 취소 철회 버튼 클릭 → 즉시 활성 상태로 복귀

---

## 3. 기능 요구사항

### 3.1 사용자 인증
- Google 계정으로 간편 로그인
- 회원가입/로그인/로그아웃 기능
- 로그인 시 사용자 정보 자동 동기화
- 사용자별 분석 이력 및 구독 정보 관리

### 3.2 사주 분석 기능

#### 입력 정보
- 성함
- 생년월일
- 출생시간 (선택)
- 성별

#### 분석 결과
- 천간(天干)과 지지(地支)
- 오행(五行) 분석
- 대운(大運)과 세운(歲運)
- 성격, 재운, 건강운, 연애운 종합 분석

#### 등급별 서비스
| 구분 | 이용 횟수 | 분석 품질 |
|------|-----------|-----------|
| 무료 | 최초 3회 | 기본 분석 |
| Pro | 월 10회 | 고급 분석 |

### 3.3 구독 및 결제

#### 구독 플랜
- **무료**: 최초 3회 제공
- **Pro**: 월 9,900원, 월 10회 고급 분석 제공

#### 구독 가입
1. 구독 관리 페이지에서 Pro 구독 신청
2. 카드 정보 입력 및 인증
3. 최초 결제 (9,900원) 즉시 실행
4. Pro 활성화 및 분석 횟수 10회 지급

#### 구독 상태
- **활성**: 정상 이용 중
- **취소 예정**: 다음 결제일까지 혜택 유지
- **만료**: 구독 종료
- **실패**: 결제 실패로 자동 해지

#### 구독 취소 및 재가입
- 언제든 취소 가능, 다음 결제일까지 혜택 유지
- 취소 예정 상태에서 철회 가능
- 재가입 시 카드 정보 재등록 필요

#### 자동 결제
- 매일 자동 실행
- 결제일 도래 구독 자동 처리
- 결제 성공: 분석 횟수 10회 추가, 구독 기간 1개월 연장
- 결제 실패: 즉시 해지 처리

---

## 4. 비기능 요구사항

### 4.1 보안
- 인증되지 않은 사용자의 서비스 접근 제한
- 결제 정보 암호화 저장
- API 요청 검증

### 4.2 성능
- 분석 결과 생성 시간 최소화
- 페이지 로딩 속도 최적화

### 4.3 확장성
- 향후 다양한 구독 플랜 추가 가능
- AI 모델 교체 용이
